<%= title 'Encuentra Tu Mascota', visible: false %>

<section id="main-sidebar">
  <div class="sidebar-options">
    <div class="btn-group">
      <button class="btn" data-publication-type="all">
        <%= t('main.index.filters.all') %>
      </button>
      <button class="btn" data-publication-type="lost">
        <%= t('main.index.filters.lost') %>
      </button>
      <button class="btn" data-publication-type="found">
        <%= t('main.index.filters.found') %>
      </button>
      <button class="btn" data-publication-type="adoption">
        <%= t('main.index.filters.adoption') %>
      </button>
    </div>
    <a href="#" class="icon toggle-left sidebar-toggle off"></a>
  </div>

  <!-- 1. Publication list -->
  <div id="publication-list" class="sidebar-item">
    <ul></ul>
    <div class="empty-state">
      <p>
        <span class="big-icon empty-publication-list"></span>
        <%= t('.empty_publication_list') %>
      </p>
    </div>
  </div>
  <!-- 2. Publication form -->
  <div id="new-publication-container" class="sidebar-item">
    <%= render partial: 'main/extras/new_publication' %>
  </div>
  <!-- 3. Publication detail -->
  <div id="publication-detail-container" class="sidebar-item">
    <p class="detail-nav"><a href="#" class="go-back"><span class="icon back"></span><%= t('.go_back' ) %></a></p>
    <div class="publication-detail-info"></div>
    <div class="contact-info">
      <p><strong><%= t('.contact_info') %></strong> <span class="content"></span></p>
    </div>
    <div class="contact">
      <button class="btn btn-success"><%= t('.request_contact_info') %></button>
    </div>
  </div>
</section>

<section id="main-panel"></section>
<a class="sidebar-toggle on">
  <span href="#" class="icon toggle-right"></span>
</a>

<%= render partial: 'main/extras/publication_templates' %>
<%= render partial: 'main/extras/sign_in' %>
<%= render partial: 'main/extras/sign_up' %>
<%= render partial: 'main/extras/email_modal' %>

<% content_for :javascript do %>
  require(['require', 'app/main/index'], function (require) {
    require(['app/main/index'], function (view) {
      view.init(<%= {
        userSignedIn: !! current_user,
        userHasEmail: ! current_user.try(:email).blank?,
        publications: @publications.map do |publication|
          Presenters::Publication.to_json_hash(publication)
        end,
        flash: @flash_messages,
        translations: t('.js')
      }.to_json.html_safe %>);
    });
  });
<% end %>
